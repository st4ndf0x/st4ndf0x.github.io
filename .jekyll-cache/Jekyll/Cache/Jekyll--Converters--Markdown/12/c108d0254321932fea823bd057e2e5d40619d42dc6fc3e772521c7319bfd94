I"Å$<p><a href="https://tryhackme.com/room/corridor">CORRIDOR</a>
by st4ndf0x  <img src="https://tryhackme-badges.s3.amazonaws.com/StandFox.png" alt="TryHackMe" /></p>

<p>Bienvenido, tienes el placer de leer mi primer writeup!.
Hoy vamos a estar resolviendo la sala <strong>Corridor</strong>, en esta sala exploraremos una vulnerabilidad llamada ‚Äú<strong>IDOR</strong>‚Äù, la cual a muy grandes rasgos es la funci√≥n cuando una aplicaci√≥n web, permite a un usuario acceder directamente a objetos, en base a esto, debido a errores de implementaci√≥n de control de acceso, el usuario termina con el poder de acceder a objetos a los que no deber√≠a tener permisos. Esta vulnerabilidad se encuentra en el Top 10 de <strong>OWASP 2017 - Broken Access Control</strong>.</p>

<p><img src="/img/rooms/easy/corridor/banner.png" alt="alt text" title="Corridor" /></p>
<p align="center">
**Dificultad:** <span style="color:green">**F√°cil**</span> ~  **Categor√≠a: WEB**
</p>

<p><strong><em>Here we go!</em></strong></p>

<p>Iniciamos nuestra m√°quina, en conjunto de nuestra VPN, a m√≠, me entreg√≥ la siguiente direcci√≥n IP:
<img src="/img/rooms/easy/corridor/1.png" alt="alt text" /></p>

<p>Yo, lo que siempre hago y lo recomiendo en el 90% de las veces, es agregar la direcci√≥n IP a nuestro archivo /etc/hosts, por 2 motivos, primero: si nos responde alg√∫n <strong>vhost.</strong> Segundo: para no tener que acordarme de la direcci√≥n IP jaja.</p>

<p>Para esto vamos a nuestra terminal y escribimos vim /etc/hosts.
AL darle enter, nos llevar√° a un documento de texto que deber√≠a estar as√≠ (si no ha sido configurado antes):
<img src="/img/rooms/easy/corridor/2.png" alt="alt text" /></p>

<p>Entonces, lo que tocar√≠a hacer es (usando VIM), apretar la tecla INSERT y con las flechas de nuestro teclado movernos al la √∫ltima IP antes del texto comentado con un ‚Äú#‚Äù y apretar enter, y en ese nuevo espacio vac√≠o, escribir o pegar la direcci√≥n IP, luego apretar la tecla TAB y asignarle un nombre como dominio, en mi caso yo le asignar√© <strong>corridor.thm</strong>. Deber√≠a quedar algo as√≠:
<img src="/img/rooms/easy/corridor/3.png" alt="alt text" /></p>

<p>Posteriormente, para guardar los cambios, tenemos que hacer los siguientes pasos:</p>
<ol>
  <li>Apretar <strong>ESC</strong></li>
  <li>Escribir dos puntos ‚Äú<strong>:</strong>‚Äù</li>
  <li>Escribir ‚Äú<strong>wq!</strong>‚Äù (<em>w=write(escribir), q=quit(salir), !=Forzar salida</em>)</li>
</ol>

<p>Ahora con esto realizado, estamos listos para visualizar el dominio: <strong>http://corridor.thm/</strong> en nuestro navegador, si lo hicieron bien, deber√≠a verse as√≠:
<img src="/img/rooms/easy/corridor/4.png" alt="alt text" /></p>

<p>Vemos que est√° funcionando correctamente. Ahora nos muestra una p√°gina web, en la cual podemos ver 13 puertas iguales, 6 a nuestro lado izquierdo, 6 a nuestro lado derecho y una en frente al fondo. Si pasamos el mouse por encima de la manilla de las mismas, podemos ver que cambia el logo de nuestro puntero y si holdeamos con el mouse, podemos ver que en cada puerta nos muestra un hash diferente. Un hash que a simple vista, pareciera ser MD5. Entonces‚Ä¶ <strong>¬øabramos todas las puertas en una nueva pesta√±a?</strong>:
<img src="/img/rooms/easy/corridor/5.png" alt="alt text" /></p>

<p>En cada puerta que ‚Äúabrimos‚Äù, nos muestra la misma imagen, una sala en blanco vac√≠a, sin ninguna diferencia entre las demas. Pero si nos fijamos bien, cada sala nos muestra una URL diferente, con un HASH diferente:</p>

<p><em>Para no rellenar la p√°gina con 13 imagenes, solo mostrar√© 3</em>
<img src="/img/rooms/easy/corridor/6.png" alt="alt text" />
<img src="/img/rooms/easy/corridor/7.png" alt="alt text" />
<img src="/img/rooms/easy/corridor/8.png" alt="alt text" /></p>

<p>Bien, ahora lo primero que haremos, ser√° confirmar si estoy en lo correcto, usando la aplicaci√≥n <strong>hash-identifier</strong> que viene incluida en Kali Linux, copiaremos cualquier hash y verificaremos que sea MD5.</p>

<p>Para esto, solo escribimos <strong>hash-identifier</strong> en la terminal de Kali y luego pegamos nuestro hash (para confirmar que sean todos, puedes  poner todos uno por uno, pero a simple vista son todos MD5, as√≠ que no es necesario, sin embargo, te invito a probar!)
<img src="/img/rooms/easy/corridor/9.png" alt="alt text" />
<strong>Efectivamente.</strong></p>

<p>Qu√© es un <strong>HASH</strong>?</p>

<p>Un hash a muy grandes rasgos, es una funci√≥n criptogr√°fica, que genera valores √∫nicos e irrepetibles. Practicamente es m√©todo de codificaci√≥n.</p>

<p>En base a esto, haremos la funcion inversa a la codificaci√≥n, realizaremos la decodificaci√≥n de estos hashes, esto lo haremos utilizando otra aplicaci√≥n m√°s que viene incluida en nuestro Kali Linux, llamada <strong>hashcat</strong>. Pero antes, necesitamos reunir todos los hashes de cada una de las salas en un archivo de texto, algo como esto:
<img src="/img/rooms/easy/corridor/10.png" alt="alt text" /></p>

<p><em>Nosotros podemos usar muchas herramientas para esto, en este writeup mostrar√© una forma ‚Äúlocal‚Äù y otra ‚Äúonline‚Äù de hacerlo.</em></p>

<p>Entonces, vamos a nuestra terminal y escribimos lo siguiente:</p>

<p><strong>hashcat -m 0 ‚Äúhash.txt‚Äù /usr/share/wordlist/rockyou.txt</strong></p>

<p>Traducci√≥n del comando:</p>

<p><strong>-m</strong>= Modo - Con esto le decimos a hashcat que algoritmo de codificaci√≥n que vamos a insertar.</p>

<p><strong>0</strong>= Modo MD5</p>

<p><strong>‚Äúhash.txt‚Äù</strong>= Ingresamos la ruta de nuestro archivo con los hashes, en este caso, como el archivo est√° en el mismo directorio donde voy a correr hashcat,  el m√≠o es <strong>hash.txt</strong></p>

<p><strong>/usr/share/wordlist/rockyou.txt</strong>= Le decimos la ruta del diccionario que queremos usar, en este caso y en el de la mayor√≠a de los CTF, rockyou.txt.</p>

<p>Lo ejecutamos y deber√≠a mostrar el procedimiento de decodificaci√≥n, algo como esto:
<img src="/img/rooms/easy/corridor/11.png" alt="alt text" />
<em>Imagen sacada de hashcat.net ya que como yo ya hice la m√°quina, el verbose es distinto.</em></p>

<p>En algunos equipos puede demorar m√°s, en otros puede durar menos, no te apures.</p>

<p>Si en el campo de <strong>Status</strong> dice <strong>Cracked</strong>, felicitaciones! has crackeado los hashes MD5.
Ahora para ver el resultado de esta decodificaci√≥n, utilizamos el mismo comando que usamos para crackear, pero al final del comando agregamos el argumento <strong>‚Äìshow</strong>, esto para que nos muestre el resultado:
<img src="/img/rooms/easy/corridor/12.png" alt="alt text" /></p>

<p>El otro m√©todo, es usar la p√°gina <a href="https://crackstation.net/">Crackstation</a>.</p>

<p>Simplemente, entramos al link enlazado anteriormente y nos aparecer√° la p√°gina de inicio junto a un recuadro en blanco grande, dentro de el, copiamos los mismos hashes que anteriormente guardamos y luego damos click en <strong>Crack Hashes</strong>, esta opci√≥n es m√°s rapida si y solo si, la p√°gina tiene en su base de datos el hash que buscamos. Te recomiendo investigar m√°s a profundo la p√°gina, <em>¬øpuedes creer que mas de 190GB en hashes MD5 &amp; SHA1?</em></p>

<p>Y finalemente, nos muestra el resultado de los hashes ingresados!
<img src="/img/rooms/easy/corridor/crackstation.png" alt="alt text" /></p>

<p>Bien, podemos ver que cada hash, de cada puerta es un n√∫mero, que va del 1 al 13. Entonces, si pensamos y le damos una vuelta a la vulnerabilidad <strong>IDOR</strong>, que pasar√≠a si intentamos entrar a una puerta fuera del alcance?, como quiz√°s el 14, o inclusive el 0?, vamos a intentarlo, para que funcione, tenemos que hacerlo en el mismo formato en el que est√°n codificadas, osea MD5.</p>

<p>Para esto, podemos buscar en google algo as√≠ ‚Äú<em>md5 encoder</em>‚Äù, yo personalmente recomomiendo <a href="https://elmah.io/tools/md5-encoder/">elmah.io</a>.</p>

<p>Dentro, vamos a escribir el texto que queremos que se codifique en MD5, probaremos primero con <strong>14</strong>:
<img src="/img/rooms/easy/corridor/13.png" alt="alt text" /></p>

<p>Bueno, nos entrega este resultado, entonces, <em>¬øprobamos?</em>.</p>

<p>Insertemoslo en nuestra URL a ver si nos muestra algo:
<img src="/img/rooms/easy/corridor/14.png" alt="alt text" />
<em>Aparentemente, no nos muestra nada jaja, <strong>pero no perdamos la esperanza!</strong></em></p>

<p>Probemos hasheando el n√∫mero 0, quiz√°s, es el n√∫mero de la suerte. Nos entrega el siguiente hash:
<img src="/img/rooms/easy/corridor/15.png" alt="alt text" /></p>

<p>Entonces ahora, como hicimos reci√©n, pongamos el hash entregado en la URL.
<img src="/img/rooms/easy/corridor/16.png" alt="alt text" /></p>

<p><strong>GUAL√Å!!!, tenemos la flag!</strong> (<em>censurada por pol√≠ticas de THM</em>)</p>

<hr />

<p>Si te ha gustado el writeup, te invito a que me apoyes, siguiendome en mi redes sociales, no te olvides que tambi√©n tengo la versi√≥n en video en la plataforma de <strong>YouTube</strong> de esta misma sala!!</p>

<p><a href="https://www.youtube.com/watch?v=RNwifym-q54">TryHackMe ~ Corridor ~ WriteUp en Espa√±ol ~ Paso a Paso</a></p>

<p>Agradecer√≠a mucho si pudieses compartirlo con tus amigos o personas que le gustar√≠a leer mi contenido!.</p>

<p><strong>Nos vemos !!!</strong></p>
:ET