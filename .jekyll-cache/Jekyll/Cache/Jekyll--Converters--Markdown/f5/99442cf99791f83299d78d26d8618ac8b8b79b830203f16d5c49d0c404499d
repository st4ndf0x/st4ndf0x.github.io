I"Á<p>Corridor
Espa√±ol</p>

<p>Bienvenido, tienes el placer de leer mi primer writeup!.
Hoy vamos a estar resolviendo la sala Corridor, en esta sala exploraremos una vulnerabilidad llamada ‚ÄúIDOR‚Äù, la cual a muy grandes rasgos es la funci√≥n cuando una aplicaci√≥n (en este caso web), permite a un usuario acceder directamente a objetos, en base a esto, debido a errores de implementaci√≥n de control de acceso, el usuario termina con el poder de acceder a objetos/directorios a los que no deber√≠a tener permisos. Esta vulnerabilidad se encuentra en el Top 10 de OWASP 2017 - Broken Access Control.</p>

<p>Dificultad: F√°cil ~  Categor√≠a: WEB</p>

<p>Here we go!</p>

<p>Iniciamos nuestra m√°quina, en conjunto de nuestra VPN, a m√≠, me entreg√≥ la siguiente direcci√≥n IP:</p>

<p>Yo, lo que siempre hago y lo recomiendo en el 90% de las veces, es agregar la direcci√≥n IP a nuestro archivo /etc/hosts, por 2 motivos, por si nos responde alg√∫n vhost y para no tener que acordarme de la direcci√≥n xD.</p>

<p>Para esto vamos a nuestra terminal y escribimos vim /etc/hosts.
AL darle enter, nos llevar√° a un documento de texto que deber√≠a estar as√≠, si no ha sido configurado antes:</p>

<p>Entonces, lo que tocar√≠a hacer es (usando VIM), apretar la tecla INSERT y con las flechas de nuestro teclado movernos al la √∫ltima IP antes del texto comentado con un ‚Äú#‚Äù y apretar enter, y en ese nuevo espacio vac√≠o, escribir o pegar la direcci√≥n IP, luego apretar la tecla TAB y asignarle un nombre como dominio, en mi caso yo le asignar√© corridor.thm. Deber√≠a quedar algo as√≠:</p>

<p>Posteriormente, para guardar los cambios, tenemos que hacer los siguientes pasos:</p>

<p>Apretar ESC
  Escribir dos puntos ‚Äú:‚Äù
  Escribir ‚Äúwq!‚Äù (w=write(escribir), q=quit(salir), !=Forzar salida)</p>

<p>Ahora con esto realizado, estamos listos para visualizar el dominio en el navegador: http://corridor.thm</p>

<p>Vemos que est√° funcionando correctamente. Ahora nos muestra una p√°gina web, en la cual podemos ver 13 puertas iguales, 6 a nuestro lado izquierdo, 6 a nuestro lado derecho y una en frente al fondo. Si pasamos el mouse por encima de la manilla de las mismas, podemos ver que cambia el logo de nuestro puntero y si holdeamos con el mouse, podemos ver que en cada puerta nos muestra un hash diferente. Un hash que a simple vista, pareciera ser MD5. Entonces ¬øabramos todas las puertas en una nueva pesta√±a?</p>

<p>En cada puerta que ‚Äúabrimos‚Äù, nos muestra la misma imagen, una sala en blanco vac√≠a, sin ninguna diferencia entre las demas. Pero si nos fijamos bien, cada sala nos muestra una URL diferente, con un HASH diferente.</p>

<p>Para no rellenar la p√°gina con 13 imagenes, solo mostrar√© 3</p>

<p>Bien, ahora lo primero que haremos, ser√° confirmar si estoy en lo correcto, usando la aplicaci√≥n hash-identifier que viene incluida en Kali Linux, copiaremos cualquier hash y verificaremos que sea MD5.</p>

<p>Para esto, solo escribimos hash-identifier en la terminal de Kali y luego pegamos nuestro hash (para confirmar que sean todos, podr√≠an pone todos uno por uno, pero a simple vista son todos MD5, as√≠ que no es necesario, pero igualmente, te invito a probar!)</p>

<p>Efectivamente</p>

<p>Qu√© es un HASH?
Un hash a muy grandes rasgos, es una funci√≥n criptogr√°fica, que genera valores √∫nicos e irrepetibles. Practicamente es m√©todo de encriptamiento.</p>

<p>En base a esto, haremos la funcion inversa, realizaremos el desencriptamiento de estos hashes, esto lo haremos utilizando otra aplicaci√≥n m√°s que viene incluida en nuestro Kali Linux, llamada hashcat. Pero antes, necesitamos reunir todos los hashes de cada una de las salas en un archivo de texto, algo como esto:</p>

<p>Nosotros podemos usar muchas herramientas para esto, en este writeup mostrar√© una forma ‚Äúlocal‚Äù y otra ‚Äúonline‚Äù de hacerlo</p>

<p>Entonces, vamos a nuestra terminal y escribimos lo siguiente:
hashcat -m 0 ‚Äúhash.txt‚Äù /usr/share/wordlist/rockyou.txt</p>

<p>Definici√≥n de comandos:
-m= Modo - Con esto le decimos a hashcat que algoritmo de desencriptamiento utilizaremos
0= Modo MD5
‚Äúhash.txt‚Äù= Ingresamos la ruta de nuestro archivo con los hashes, en este caso el m√≠o es hash.txt
/usr/share/wordlist/rockyou.txt= Le decimos la ruta del diccionario que queremos usar, en este caso y en el de la mayor√≠a de los CTF, rockyou.txt.</p>

<p>Lo ejecutamos y deber√≠a mostrar el procedimiento de decodificaci√≥n, algo como esto:</p>

<p>Imagen sacada de hashcat.net ya que como yo ya hice la m√°quina, el verbose es distinto</p>

<p>Si en el campo de Status dice Cracked, felicitaciones! has crackeado hashes MD5.
Ahora para ver el resultado de esta decodificaci√≥n, utilizamos el mismo comando que usamos para creackear, pero al final del comando agregamos el argumento ‚Äìshow, esto para que nos muestre el resultado. Deber√≠a mostrar esto:</p>

<p>El otro m√©todo, es usar la p√°gina Crackstation.</p>

<p>Simplemente, entramos al link enlazado anteriormente y nos aparecer√° la p√°gina de inicio junto a un recuadro en blanco grande, dentro de el, copiamos los mismos hashes que anteriormente guardamos y luego damos click en Crack Hashes, esta opci√≥n es m√°s rapida si y solo si, la p√°gina tiene en su base de datos el hash que buscamos. Te recomiendo investigar m√°s a profundo la p√°gina, ¬øpuedes creer que mas de 190GB en hashes MD5 &amp; SHA1?</p>

<p>Y finalemente, nos muestra el resultado de los hashes ingresados!</p>

<p>Bien, podemos ver que cada hash, de cada puerta es un n√∫mero, que va del 1 al 13. Entonces, si pensamos y le damos una vuelta a la vulnerabilidad IDOR, que pasar√≠a si intentamos entrar a una puerta fuera del alcance?, como quiz√°s el 14, o inclusive el 0?, vamos a intentarlo, para que funcione, tenemos que hacerlo en el mismo formato en el que est√°n encriptadas, MD5.</p>
:ET