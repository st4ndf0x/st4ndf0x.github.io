I"<p>Corridor
Español</p>

<p>Bienvenido, tienes el placer de leer mi primer writeup!.
Hoy vamos a estar resolviendo la sala Corridor, en esta sala exploraremos una vulnerabilidad llamada “IDOR”, la cual a muy grandes rasgos es la función cuando una aplicación (en este caso web), permite a un usuario acceder directamente a objetos, en base a esto, debido a errores de implementación de control de acceso, el usuario termina con el poder de acceder a objetos/directorios a los que no debería tener permisos. Esta vulnerabilidad se encuentra en el Top 10 de OWASP 2017 - Broken Access Control.</p>

<p>Dificultad: Fácil ~  Categoría: WEB</p>

<p>Here we go!</p>

<p>Iniciamos nuestra máquina, en conjunto de nuestra VPN, a mí, me entregó la siguiente dirección IP:</p>

<p>Yo, lo que siempre hago y lo recomiendo en el 90% de las veces, es agregar la dirección IP a nuestro archivo /etc/hosts, por 2 motivos, por si nos responde algún vhost y para no tener que acordarme de la dirección xD.</p>

<p>Para esto vamos a nuestra terminal y escribimos vim /etc/hosts.
AL darle enter, nos llevará a un documento de texto que debería estar así, si no ha sido configurado antes:</p>

<p>Entonces, lo que tocaría hacer es (usando VIM), apretar la tecla INSERT y con las flechas de nuestro teclado movernos al la última IP antes del texto comentado con un “#” y apretar enter, y en ese nuevo espacio vacío, escribir o pegar la dirección IP, luego apretar la tecla TAB y asignarle un nombre como dominio, en mi caso yo le asignaré corridor.thm. Debería quedar algo así:</p>

<p>Posteriormente, para guardar los cambios, tenemos que hacer los siguientes pasos:</p>

<p>Apretar ESC
  Escribir dos puntos “:”
  Escribir “wq!” (w=write(escribir),q=quit(salir),!=Forzar salida)</p>

<p>Ahora con esto realizado, estamos listos para visualizar el dominio en el navegador: http://corridor.thm</p>

<p>Vemos que está funcionando correctamente. Ahora nos muestra una página web, en la cual podemos ver 13 puertas iguales, 6 a nuestro lado izquierdo, 6 a nuestro lado derecho y una en frente al fondo. Si pasamos el mouse por encima de la manilla de las mismas, podemos ver que cambia el logo de nuestro puntero y si holdeamos con el mouse, podemos ver que en cada puerta nos muestra un hash diferente. Un hash que a simple vista, pareciera ser MD5. Entonces ¿abramos todas las puertas en una nueva pestaña?</p>

<p>En cada puerta que “abrimos”, nos muestra la misma imagen, una sala en blanco vacía, sin ninguna diferencia entre las demas. Pero si nos fijamos bien, cada sala nos muestra una URL diferente, con un HASH diferente.</p>

<p>Para no rellenar la página con 13 imagenes, solo mostraré 3</p>

<p>Bien, ahora lo primero que haremos, será confirmar si estoy en lo correcto, usando la aplicación hash-identifier que viene incluida en Kali Linux, copiaremos cualquier hash y verificaremos que sea MD5.</p>

<p>Para esto, solo escribimos hash-identifier en la terminal de Kali y luego pegamos nuestro hash (para confirmar que sean todos, podrían pone todos uno por uno, pero a simple vista son todos MD5, así que no es necesario, pero igualmente, te invito a probar!)</p>

<p>Efectivamente</p>

<p>Qué es un HASH?
Un hash a muy grandes rasgos, es una función criptográfica, que genera valores únicos e irrepetibles. Practicamente es método de encriptamiento.</p>

<p>En base a esto, haremos la funcion inversa, realizaremos el desencriptamiento de estos hashes, esto lo haremos utilizando otra aplicación más que viene incluida en nuestro Kali Linux, llamada hashcat. Pero antes, necesitamos reunir todos los hashes de cada una de las salas en un archivo de texto, algo como esto:</p>

<p>Nosotros podemos usar muchas herramientas para esto, en este writeup mostraré una forma “local” y otra “online” de hacerlo</p>

<p>Entonces, vamos a nuestra terminal y escribimos lo siguiente:
hashcat -m 0 “hash.txt” /usr/share/wordlist/rockyou.txt</p>

<p>Definición de comandos:
-m= Modo - Con esto le decimos a hashcat que algoritmo de desencriptamiento utilizaremos
0= Modo MD5
“hash.txt”= Ingresamos la ruta de nuestro archivo con los hashes, en este caso el mío es hash.txt
/usr/share/wordlist/rockyou.txt= Le decimos la ruta del diccionario que queremos usar, en este caso y en el de la mayoría de los CTF, rockyou.txt.</p>

<p>Lo ejecutamos y debería mostrar el procedimiento de decodificación, algo como esto:</p>

<p>Imagen sacada de hashcat.net ya que como yo ya hice la máquina, el verbose es distinto</p>

<p>Si en el campo de Status dice Cracked, felicitaciones! has crackeado hashes MD5.
Ahora para ver el resultado de esta decodificación, utilizamos el mismo comando que usamos para creackear, pero al final del comando agregamos el argumento –show, esto para que nos muestre el resultado. Debería mostrar esto:</p>

:ET